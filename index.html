<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KVC Westerlo - Elite Recruitment Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { --primary: #1a2a6c; --secondary: #b21f1f; --bg: #f4f7f6; --text: #333; }
        
        /* Mobile-Responsive CSS */
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); padding: 10px; margin: 0; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        
        h1 { color: var(--primary); text-align: center; font-size: 1.5rem; text-transform: uppercase; }
        .section-header { background: var(--primary); color: white; padding: 12px; margin-top: 25px; border-radius: 4px; font-weight: bold; }
        
        .question { margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
        .options { display: flex; flex-direction: column; gap: 8px; }
        
        /* Large touch targets for iPad/iPhone */
        label { background: #f9f9f9; padding: 15px; border: 1px solid #ddd; border-radius: 6px; cursor: pointer; display: block; }
        input[type="radio"] { transform: scale(1.2); margin-right: 10px; }

        #coach-section { display: none; margin-top: 40px; border: 3px dashed var(--secondary); padding: 20px; border-radius: 10px; background: #fff8f8; }
        
        .btn-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-top: 30px; }
        button { padding: 15px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; min-width: 160px; color: white; }
        .btn-calc { background: var(--primary); }
        .btn-print { background: var(--secondary); }
        .btn-save { background: #28a745; }
        .btn-coach { background: #444; }

        table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 0.9rem; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background: var(--primary); color: white; }
        textarea { width: 100%; height: 80px; margin-top: 10px; box-sizing: border-box; }

        /* Print Page Breaks */
        .pdf-page-break { page-break-before: always; height: 10px; }
    </style>
</head>
<body>

<div class="container" id="assessment-content">
    <h1>Elite Performance Assessment</h1>
    <p style="text-align: center; font-size: 0.9rem;">KVC WESTERLO RECRUITMENT - 2025/2026</p>

    <div class="section-header">Player Information</div>
    <div class="question">
        <p>Full Name:</p>
        <input type="text" id="playerName" placeholder="Enter full name" style="width: 100%; padding: 12px; box-sizing: border-box;">
        <p>Position:</p>
        <input type="text" id="playerPosition" placeholder="e.g. Attacker" style="width: 100%; padding: 12px; box-sizing: border-box;">
    </div>

    <div id="survey-questions"></div>

    <div class="btn-container">
        <button class="btn-coach" onclick="unlockCoach()">Coach Access</button>
    </div>

    <div id="coach-section">
        <p style="color:red; font-weight:bold; text-align:center;">CONFIDENTIAL: COACH ONLY</p>
        <div id="result-display" style="background:#eef2ff; padding:15px; border-radius:5px; margin-bottom:20px;"></div>
        
        <div class="pdf-page-break"></div>
        <h2>Jungian Scoring Matrix</h2>
        <table id="scoringTable">
            <thead><tr><th>Segment</th><th>Score</th></tr></thead>
            <tbody id="scoringBody"></tbody>
        </table>

        <div class="pdf-page-break"></div>
        <h2>Interview Notes</h2>
        <p><strong>1. Physical Drain Test:</strong></p>
        <textarea id="note1"></textarea>
        <p><strong>2. Unfair Criticism Anchor:</strong></p>
        <textarea id="note2"></textarea>
        <p><strong>3. Incomplete Map Intuition:</strong></p>
        <textarea id="note3"></textarea>
        <p><strong>Final Summary:</strong></p>
        <textarea id="coachComments"></textarea>
    </div>

    <div class="btn-container">
        <button class="btn-calc" onclick="calculateProfile()">Generate Result</button>
        <button class="btn-print" onclick="printPDF()">Print PDF Report</button>
        <button class="btn-save" onclick="saveAsText()">Save Data File</button>
    </div>
</div>

<script>
    const questions = [
        ["TF", "When I face a major setback, my internal monologue is:", "Why me?", "Talk to someone.", "What is the lesson? Adjust.", "Forget and move on."],
        ["SN", "Relationship with failure?", "A wall.", "Avoid at all costs.", "A stepping stone.", "Temporary blow."],
        ["EI", "In a silent locker room after a loss, the best action is:", "Stay silent.", "Speak up with positive goal.", "Analyze stats alone.", "Wait for captain."],
        ["SN", "Learning a new tactic:", "Listen to coach.", "See board + Walk through.", "Read notes.", "Feel emotions."],
        ["JP", "Phone policy in Gym/Physio:", "Stay connected.", "In the box/locker.", "Mirror seniors.", "Music only."]
        // Note: For brevity, add more questions here following this pattern
    ];

    function renderQuestions() {
        const container = document.getElementById('survey-questions');
        questions.forEach((q, i) => {
            const div = document.createElement('div');
            div.className = 'question';
            div.innerHTML = `<p>${i+1}. ${q[1]}</p>
                <div class="options">
                    <label><input type="radio" name="q${i}" value="a"> ${q[2]}</label>
                    <label><input type="radio" name="q${i}" value="b"> ${q[3]}</label>
                    <label><input type="radio" name="q${i}" value="c"> ${q[4]}</label>
                    <label><input type="radio" name="q${i}" value="d"> ${q[5]}</label>
                </div>`;
            container.appendChild(div);
        });
    }

    function unlockCoach() {
        if(prompt("Coach Password:") === "kvc2025") {
            document.getElementById('coach-section').style.display = 'block';
            alert("Unlocked. You can now include this section in your PDF.");
        }
    }

    function calculateProfile() {
        let scores = { E:0, I:0, S:0, N:0, T:0, F:0, J:0, P:0 };
        questions.forEach((q, i) => {
            const sel = document.querySelector(`input[name="q${i}"]:checked`);
            if(!sel) return;
            const type = q[0];
            if(sel.value === 'c') { 
                if(type.includes("E")) scores.E++; if(type.includes("N")) scores.N++; if(type.includes("T")) scores.T++; if(type.includes("J")) scores.J++;
            } else if(sel.value === 'a') {
                if(type.includes("I")) scores.I++; if(type.includes("S")) scores.S++; if(type.includes("F")) scores.F++; if(type.includes("P")) scores.P++;
            }
        });
        const profile = [(scores.E >= scores.I ? "E" : "I"), (scores.S >= scores.N ? "S" : "N"), (scores.T >= scores.F ? "T" : "F"), (scores.J >= scores.P ? "J" : "P")].join('');
        document.getElementById('result-display').innerHTML = `<h3>Profile: ${profile}</h3>`;
        document.getElementById('scoringBody').innerHTML = `
            <tr><td>Energy</td><td>E:${scores.E} vs I:${scores.I}</td></tr>
            <tr><td>Information</td><td>S:${scores.S} vs N:${scores.N}</td></tr>
            <tr><td>Decision</td><td>T:${scores.T} vs F:${scores.F}</td></tr>`;
    }

    function printPDF() {
        const name = document.getElementById('playerName').value || "Player";
        const element = document.getElementById('assessment-content');
        
        // Settings to fix blank pages and mobile support
        const opt = {
            margin: [10, 10],
            filename: `KVC_Elite_Report_${name.replace(/\s+/g, '_')}.pdf`,
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2, useCORS: true, logging: false, letterRendering: true },
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
        };

        // Execution
        html2pdf().set(opt).from(element).save();
    }

    function saveAsText() {
        const name = document.getElementById('playerName').value || "Anoniem";
        const content = `ASSESSMENT: ${name}\nPROFILE: ${document.getElementById('result-display').innerText}\nNOTES: ${document.getElementById('coachComments').value}`;
        const blob = new Blob([content], { type: 'text/plain' });
        const a = document.createElement('a');
        a.download = `${name.replace(/\s+/g, '_')}_Data.txt`;
        a.href = URL.createObjectURL(blob);
        a.click();
    }

    renderQuestions();
</script>
</body>
</html>
